language: java

jdk:
  - openjdk8

script:
  - mvn test -B

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: KCfNCt/2rrBttkyTwu0qhecumsLnfNP6xBHOos6Kpb0xCz7Q6QWXvBTazVWx+zcFHxK4Zx5Mb23+8rr1QYMAD3XSwiBQonC81amBcRUgdY4vYlUqUFbZjn60bB/PLF568Kt7u88oGwXS93lw0LYXdfQkphQKm5UBEHgpUx6ThVuwgOQ73wvXap9oO6mc39mvno+Pq+hWmLFNWLkmdnKcF70H1EOLd3jqA6xwAlqysSdudzqV8qn7fnxFC3a35FRpP39eFnF2vyCrn+6k146db34xjD24Mv1gKzRfdtHDnZvOIN31YxxdGSHV2YkWnWvTYfwD5fcjSofNZo98uqCk8WqFw5Zpyq9dxNjnm/N/G2B4jS3Tv+o1ki3xzlQbRWlJQCXVXfaCD3fFYHkjVCTLjP/ykdbWTivl2pbKAvgHHmhFmQbfHEP9e8bjiID1Cxm6fP1ue+Qjr/3CcdRoEVHAJqDj5XLb8I3W0Id0oTPc3L7RmE+XQi5GI+EdQx8qhdDuK2Sm/pPpIRHvoqzxZbuTyMzFJXoGEj0EkepfZ2mOwWoCpAdjJYanSKL/BkkxpqGNAlEdszRSQyHKjrxL3SEwhfF1hRqPpgYl8E1uIZ9Wc3qL32/+ZSoFnQSax2pqxJ52/tTclL8nmmHiKkiFldmDGzuKXWoNl/GpVEFlAyYntus=
  file: "target/spt-development-test-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
