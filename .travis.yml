language: java

jdk:
  - openjdk8

script:
  - mvn test -B

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: ldQefG9ISjNfqrZJZOVw71JFhK52p8cKixXhEIth7/2V++axCE1bjF5aR6Y4AGTxl0xhTAHh/XO0sEtp54+N0fvXBoRNtMAsM3fPQv1ftxUdC1C7XJ4idUI/ZefoncP2GLlB+D5x4lxDrovEXj0icGLUopz9fa/ob0mAHT9GGBmD96yTyViFfJoGsJlq915zhTg31lQ57pDkWuVESM2Qf0z2Ts5Lz30maWkcHIv/+E0K8ZkqYE2xXIzo9HS0htvl0F5chE0G3vQf3wFJiqziaMsVib3aZXETiy93GhfD4vCOtYlg2JkYhFdfhjj+OAqmRSiorJWDSjP2FHlMG3Rvn72rwatxvPcJGHSNpg1wZAWbUpOo13ujJw9ijO9uyQCNqbUMPKJd+bKPoiESlTPYAg4XQI1bcZskjxuNPw6zNXy8dtc9h8ADPi0Q1yybnxNCXWYKFzxzN2DQfTUSNEThJon8pNMGrCeIq0lCerehTvxjT9GPm00jsruMfWh+cBh91ofeF2YmtjuBypNT1bVD0NbTcgnxXoro/Jyv1Y16Pj2vJFLkLnD4d8jtu2xhSCgDfqqlLu9gy5rdvpg3PXQy2c1mwOmVG+nbZKINobldzAE0Xtmtnowl1GTLgIdjb5rlPiJTKfu/Av4ERs5+3OKOTQBoPOvBneBAQHDzuO7rNJE=
  file: "target/spt-development-test-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true
